import e from"buffer";import t from"stream";import r from"util";import n from"crypto";import{webcrypto as s,createVerify as i}from"node:crypto";import*as a from"url";import*as o from"https";const u=128;let c,l;function d(e=21){var t;t=e-=0,!c||c.length<t?(c=Buffer.allocUnsafe(t*u),s.getRandomValues(c),l=0):l+t>c.length&&(s.getRandomValues(c),l=0),l+=t;let r="";for(let t=l-e;t<l;t++)r+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&c[t]];return r}var h="object"==typeof global&&global&&global.Object===Object&&global,p="object"==typeof self&&self&&self.Object===Object&&self,f=h||p||Function("return this")(),m=f.Symbol,y=Object.prototype,v=y.hasOwnProperty,g=y.toString,b=m?m.toStringTag:void 0;var _=Object.prototype.toString;var E="[object Null]",w="[object Undefined]",S=m?m.toStringTag:void 0;function x(e){return null==e?void 0===e?w:E:S&&S in Object(e)?function(e){var t=v.call(e,b),r=e[b];try{e[b]=void 0;var n=!0}catch(e){}var s=g.call(e);return n&&(t?e[b]=r:delete e[b]),s}(e):function(e){return _.call(e)}(e)}function T(e){return null!=e&&"object"==typeof e}var O=Array.isArray;function k(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var I="[object AsyncFunction]",j="[object Function]",R="[object GeneratorFunction]",N="[object Proxy]";function $(e){if(!k(e))return!1;var t=x(e);return t==j||t==R||t==I||t==N}var A,P=f["__core-js_shared__"],L=(A=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"";var C=Function.prototype.toString;function Z(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var D=/^\[object .+?Constructor\]$/,M=Function.prototype,U=Object.prototype,B=M.toString,F=U.hasOwnProperty,V=RegExp("^"+B.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function K(e){return!(!k(e)||(t=e,L&&L in t))&&($(e)?V:D).test(Z(e));var t}function G(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return K(r)?r:void 0}var z=G(f,"WeakMap"),H=9007199254740991;function X(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=H}var q=Object.prototype;function W(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||q)}function J(e){return T(e)&&"[object Arguments]"==x(e)}var Y=Object.prototype,Q=Y.hasOwnProperty,ee=Y.propertyIsEnumerable,te=J(function(){return arguments}())?J:function(e){return T(e)&&Q.call(e,"callee")&&!ee.call(e,"callee")};var re="object"==typeof exports&&exports&&!exports.nodeType&&exports,ne=re&&"object"==typeof module&&module&&!module.nodeType&&module,se=ne&&ne.exports===re?f.Buffer:void 0,ie=(se?se.isBuffer:void 0)||function(){return!1},ae={};ae["[object Float32Array]"]=ae["[object Float64Array]"]=ae["[object Int8Array]"]=ae["[object Int16Array]"]=ae["[object Int32Array]"]=ae["[object Uint8Array]"]=ae["[object Uint8ClampedArray]"]=ae["[object Uint16Array]"]=ae["[object Uint32Array]"]=!0,ae["[object Arguments]"]=ae["[object Array]"]=ae["[object ArrayBuffer]"]=ae["[object Boolean]"]=ae["[object DataView]"]=ae["[object Date]"]=ae["[object Error]"]=ae["[object Function]"]=ae["[object Map]"]=ae["[object Number]"]=ae["[object Object]"]=ae["[object RegExp]"]=ae["[object Set]"]=ae["[object String]"]=ae["[object WeakMap]"]=!1;var oe,ue="object"==typeof exports&&exports&&!exports.nodeType&&exports,ce=ue&&"object"==typeof module&&module&&!module.nodeType&&module,le=ce&&ce.exports===ue&&h.process,de=function(){try{var e=ce&&ce.require&&ce.require("util").types;return e||le&&le.binding&&le.binding("util")}catch(e){}}(),he=de&&de.isTypedArray,pe=he?(oe=he,function(e){return oe(e)}):function(e){return T(e)&&X(e.length)&&!!ae[x(e)]};var fe=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),me=Object.prototype.hasOwnProperty;var ye=G(f,"Map"),ve=G(f,"DataView"),ge=G(f,"Promise"),be=G(f,"Set"),_e="[object Map]",Ee="[object Promise]",we="[object Set]",Se="[object WeakMap]",xe="[object DataView]",Te=Z(ve),Oe=Z(ye),ke=Z(ge),Ie=Z(be),je=Z(z),Re=x;(ve&&Re(new ve(new ArrayBuffer(1)))!=xe||ye&&Re(new ye)!=_e||ge&&Re(ge.resolve())!=Ee||be&&Re(new be)!=we||z&&Re(new z)!=Se)&&(Re=function(e){var t=x(e),r="[object Object]"==t?e.constructor:void 0,n=r?Z(r):"";if(n)switch(n){case Te:return xe;case Oe:return _e;case ke:return Ee;case Ie:return we;case je:return Se}return t});var Ne,$e,Ae=Re,Pe=Object.prototype.hasOwnProperty;function Le(e){if(null==e)return!0;if(function(e){return null!=e&&X(e.length)&&!$(e)}(e)&&(O(e)||"string"==typeof e||"function"==typeof e.splice||ie(e)||pe(e)||te(e)))return!e.length;var t=Ae(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(W(e))return!function(e){if(!W(e))return fe(e);var t=[];for(var r in Object(e))me.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e).length;for(var r in e)if(Pe.call(e,r))return!1;return!0}function Ce(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(Ne||(Ne={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}($e||($e={}));const Ze=Ne.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),De=e=>{switch(typeof e){case"undefined":return Ze.undefined;case"string":return Ze.string;case"number":return isNaN(e)?Ze.nan:Ze.number;case"boolean":return Ze.boolean;case"function":return Ze.function;case"bigint":return Ze.bigint;case"symbol":return Ze.symbol;case"object":return Array.isArray(e)?Ze.array:null===e?Ze.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Ze.promise:"undefined"!=typeof Map&&e instanceof Map?Ze.map:"undefined"!=typeof Set&&e instanceof Set?Ze.set:"undefined"!=typeof Date&&e instanceof Date?Ze.date:Ze.object;default:return Ze.unknown}},Me=Ne.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ue extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(n);else if("invalid_return_type"===s.code)n(s.returnTypeError);else if("invalid_arguments"===s.code)n(s.argumentsError);else if(0===s.path.length)r._errors.push(t(s));else{let e=r,n=0;for(;n<s.path.length;){const r=s.path[n];n===s.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(s))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ne.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Ue.create=e=>new Ue(e);const Be=(e,t)=>{let r;switch(e.code){case Me.invalid_type:r=e.received===Ze.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Me.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Ne.jsonStringifyReplacer)}`;break;case Me.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ne.joinValues(e.keys,", ")}`;break;case Me.invalid_union:r="Invalid input";break;case Me.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ne.joinValues(e.options)}`;break;case Me.invalid_enum_value:r=`Invalid enum value. Expected ${Ne.joinValues(e.options)}, received '${e.received}'`;break;case Me.invalid_arguments:r="Invalid function arguments";break;case Me.invalid_return_type:r="Invalid function return type";break;case Me.invalid_date:r="Invalid date";break;case Me.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Ne.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Me.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Me.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Me.custom:r="Invalid input";break;case Me.invalid_intersection_types:r="Intersection results could not be merged";break;case Me.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Me.not_finite:r="Number must be finite";break;default:r=t.defaultError,Ne.assertNever(e)}return{message:r}};let Fe=Be;function Ve(){return Fe}const Ke=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,i=[...r,...s.path||[]],a={...s,path:i};let o="";const u=n.filter((e=>!!e)).slice().reverse();for(const e of u)o=e(a,{data:t,defaultError:o}).message;return{...s,path:i,message:s.message||o}};function Ge(e,t){const r=Ke({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,Ve(),Be].filter((e=>!!e))});e.common.issues.push(r)}class ze{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return He;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t)r.push({key:await e.key,value:await e.value});return ze.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:s}=n;if("aborted"===t.status)return He;if("aborted"===s.status)return He;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!n.alwaysSet||(r[t.value]=s.value)}return{status:e.value,value:r}}}const He=Object.freeze({status:"aborted"}),Xe=e=>({status:"dirty",value:e}),qe=e=>({status:"valid",value:e}),We=e=>"aborted"===e.status,Je=e=>"dirty"===e.status,Ye=e=>"valid"===e.status,Qe=e=>"undefined"!=typeof Promise&&e instanceof Promise;var et;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(et||(et={}));class tt{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const rt=(e,t)=>{if(Ye(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ue(e.common.issues);return this._error=t,this._error}}};function nt(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=n?n:t.defaultError}:{message:null!=r?r:t.defaultError},description:s}}class st{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return De(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:De(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ze,ctx:{common:e.parent.common,data:e.data,parsedType:De(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Qe(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)},s=this._parseSync({data:e,path:n.path,parent:n});return rt(n,s)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)},n=this._parse({data:e,path:r.path,parent:r}),s=await(Qe(n)?n:Promise.resolve(n));return rt(r,s)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const s=e(t),i=()=>n.addIssue({code:Me.custom,...r(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then((e=>!!e||(i(),!1))):!!s||(i(),!1)}))}refinement(e,t){return this._refinement(((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1)))}_refinement(e){return new Gt({schema:this,typeName:nr.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return zt.create(this,this._def)}nullable(){return Ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ot.create(this,this._def)}promise(){return Kt.create(this,this._def)}or(e){return jt.create([this,e],this._def)}and(e){return At.create(this,e,this._def)}transform(e){return new Gt({...nt(this._def),schema:this,typeName:nr.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Xt({...nt(this._def),innerType:this,defaultValue:t,typeName:nr.ZodDefault})}brand(){return new Yt({typeName:nr.ZodBranded,type:this,...nt(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new qt({...nt(this._def),innerType:this,catchValue:t,typeName:nr.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Qt.create(this,e)}readonly(){return er.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const it=/^c[^\s-]{8,}$/i,at=/^[a-z][a-z0-9]*$/,ot=/^[0-9A-HJKMNP-TV-Z]{26}$/,ut=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ct=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let lt;const dt=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,ht=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class pt extends st{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==Ze.string){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.string,received:t.parsedType}),He}const t=new ze;let r;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){const n=e.data.length>a.value,s=e.data.length<a.value;(n||s)&&(r=this._getOrReturnCtx(e,r),n?Ge(r,{code:Me.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):s&&Ge(r,{code:Me.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)ct.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"email",code:Me.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)lt||(lt=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),lt.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"emoji",code:Me.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)ut.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"uuid",code:Me.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)it.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"cuid",code:Me.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)at.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"cuid2",code:Me.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)ot.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"ulid",code:Me.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),Ge(r,{validation:"url",code:Me.invalid_string,message:a.message}),t.dirty()}else if("regex"===a.kind){a.regex.lastIndex=0;a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"regex",code:Me.invalid_string,message:a.message}),t.dirty())}else if("trim"===a.kind)e.data=e.data.trim();else if("includes"===a.kind)e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty());else if("toLowerCase"===a.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===a.kind)e.data=e.data.toUpperCase();else if("startsWith"===a.kind)e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty());else if("endsWith"===a.kind)e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty());else if("datetime"===a.kind){((i=a).precision?i.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${i.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${i.precision}}Z$`):0===i.precision?i.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):i.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.invalid_string,validation:"datetime",message:a.message}),t.dirty())}else"ip"===a.kind?(n=e.data,("v4"!==(s=a.version)&&s||!dt.test(n))&&("v6"!==s&&s||!ht.test(n))&&(r=this._getOrReturnCtx(e,r),Ge(r,{validation:"ip",code:Me.invalid_string,message:a.message}),t.dirty())):Ne.assertNever(a);var n,s,i;return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement((t=>e.test(t)),{validation:t,code:Me.invalid_string,...et.errToObj(r)})}_addCheck(e){return new pt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...et.errToObj(e)})}url(e){return this._addCheck({kind:"url",...et.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...et.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...et.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...et.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...et.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...et.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...et.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...et.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...et.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...et.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...et.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...et.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...et.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...et.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...et.errToObj(t)})}nonempty(e){return this.min(1,et.errToObj(e))}trim(){return new pt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new pt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new pt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function ft(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}pt.create=e=>{var t;return new pt({checks:[],typeName:nr.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...nt(e)})};class mt extends st{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==Ze.number){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.number,received:t.parsedType}),He}let t;const r=new ze;for(const n of this._def.checks)if("int"===n.kind)Ne.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else"multipleOf"===n.kind?0!==ft(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.not_finite,message:n.message}),r.dirty()):Ne.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,et.toString(t))}gt(e,t){return this.setLimit("min",e,!1,et.toString(t))}lte(e,t){return this.setLimit("max",e,!0,et.toString(t))}lt(e,t){return this.setLimit("max",e,!1,et.toString(t))}setLimit(e,t,r,n){return new mt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:et.toString(n)}]})}_addCheck(e){return new mt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:et.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:et.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:et.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:et.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:et.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:et.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:et.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:et.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:et.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&Ne.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}mt.create=e=>new mt({checks:[],typeName:nr.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...nt(e)});class yt extends st{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==Ze.bigint){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.bigint,received:t.parsedType}),He}let t;const r=new ze;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Ge(t,{code:Me.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):Ne.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,et.toString(t))}gt(e,t){return this.setLimit("min",e,!1,et.toString(t))}lte(e,t){return this.setLimit("max",e,!0,et.toString(t))}lt(e,t){return this.setLimit("max",e,!1,et.toString(t))}setLimit(e,t,r,n){return new yt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:et.toString(n)}]})}_addCheck(e){return new yt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:et.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:et.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:et.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:et.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:et.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}yt.create=e=>{var t;return new yt({checks:[],typeName:nr.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...nt(e)})};class vt extends st{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==Ze.boolean){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.boolean,received:t.parsedType}),He}return qe(e.data)}}vt.create=e=>new vt({typeName:nr.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...nt(e)});class gt extends st{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==Ze.date){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.date,received:t.parsedType}),He}if(isNaN(e.data.getTime())){return Ge(this._getOrReturnCtx(e),{code:Me.invalid_date}),He}const t=new ze;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:Me.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):Ne.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new gt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:et.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:et.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}gt.create=e=>new gt({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:nr.ZodDate,...nt(e)});class bt extends st{_parse(e){if(this._getType(e)!==Ze.symbol){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.symbol,received:t.parsedType}),He}return qe(e.data)}}bt.create=e=>new bt({typeName:nr.ZodSymbol,...nt(e)});class _t extends st{_parse(e){if(this._getType(e)!==Ze.undefined){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.undefined,received:t.parsedType}),He}return qe(e.data)}}_t.create=e=>new _t({typeName:nr.ZodUndefined,...nt(e)});class Et extends st{_parse(e){if(this._getType(e)!==Ze.null){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.null,received:t.parsedType}),He}return qe(e.data)}}Et.create=e=>new Et({typeName:nr.ZodNull,...nt(e)});class wt extends st{constructor(){super(...arguments),this._any=!0}_parse(e){return qe(e.data)}}wt.create=e=>new wt({typeName:nr.ZodAny,...nt(e)});class St extends st{constructor(){super(...arguments),this._unknown=!0}_parse(e){return qe(e.data)}}St.create=e=>new St({typeName:nr.ZodUnknown,...nt(e)});class xt extends st{_parse(e){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.never,received:t.parsedType}),He}}xt.create=e=>new xt({typeName:nr.ZodNever,...nt(e)});class Tt extends st{_parse(e){if(this._getType(e)!==Ze.undefined){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.void,received:t.parsedType}),He}return qe(e.data)}}Tt.create=e=>new Tt({typeName:nr.ZodVoid,...nt(e)});class Ot extends st{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==Ze.array)return Ge(t,{code:Me.invalid_type,expected:Ze.array,received:t.parsedType}),He;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,s=t.data.length<n.exactLength.value;(e||s)&&(Ge(t,{code:e?Me.too_big:Me.too_small,minimum:s?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(Ge(t,{code:Me.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(Ge(t,{code:Me.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map(((e,r)=>n.type._parseAsync(new tt(t,e,t.path,r))))).then((e=>ze.mergeArray(r,e)));const s=[...t.data].map(((e,r)=>n.type._parseSync(new tt(t,e,t.path,r))));return ze.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new Ot({...this._def,minLength:{value:e,message:et.toString(t)}})}max(e,t){return new Ot({...this._def,maxLength:{value:e,message:et.toString(t)}})}length(e,t){return new Ot({...this._def,exactLength:{value:e,message:et.toString(t)}})}nonempty(e){return this.min(1,e)}}function kt(e){if(e instanceof It){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=zt.create(kt(n))}return new It({...e._def,shape:()=>t})}return e instanceof Ot?new Ot({...e._def,type:kt(e.element)}):e instanceof zt?zt.create(kt(e.unwrap())):e instanceof Ht?Ht.create(kt(e.unwrap())):e instanceof Pt?Pt.create(e.items.map((e=>kt(e)))):e}Ot.create=(e,t)=>new Ot({type:e,minLength:null,maxLength:null,exactLength:null,typeName:nr.ZodArray,...nt(t)});class It extends st{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=Ne.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Ze.object){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.object,received:t.parsedType}),He}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:s}=this._getCached(),i=[];if(!(this._def.catchall instanceof xt&&"strip"===this._def.unknownKeys))for(const e in r.data)s.includes(e)||i.push(e);const a=[];for(const e of s){const t=n[e],s=r.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new tt(r,s,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof xt){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of i)a.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)i.length>0&&(Ge(r,{code:Me.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const n=r.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new tt(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of a){const r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>ze.mergeObjectSync(t,e))):ze.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return et.errToObj,new It({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,s,i,a;const o=null!==(i=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,r).message)&&void 0!==i?i:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=et.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new It({...this._def,unknownKeys:"strip"})}passthrough(){return new It({...this._def,unknownKeys:"passthrough"})}extend(e){return new It({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new It({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:nr.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new It({...this._def,catchall:e})}pick(e){const t={};return Ne.objectKeys(e).forEach((r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])})),new It({...this._def,shape:()=>t})}omit(e){const t={};return Ne.objectKeys(this.shape).forEach((r=>{e[r]||(t[r]=this.shape[r])})),new It({...this._def,shape:()=>t})}deepPartial(){return kt(this)}partial(e){const t={};return Ne.objectKeys(this.shape).forEach((r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()})),new It({...this._def,shape:()=>t})}required(e){const t={};return Ne.objectKeys(this.shape).forEach((r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof zt;)e=e._def.innerType;t[r]=e}})),new It({...this._def,shape:()=>t})}keyof(){return Bt(Ne.objectKeys(this.shape))}}It.create=(e,t)=>new It({shape:()=>e,unknownKeys:"strip",catchall:xt.create(),typeName:nr.ZodObject,...nt(t)}),It.strictCreate=(e,t)=>new It({shape:()=>e,unknownKeys:"strict",catchall:xt.create(),typeName:nr.ZodObject,...nt(t)}),It.lazycreate=(e,t)=>new It({shape:e,unknownKeys:"strip",catchall:xt.create(),typeName:nr.ZodObject,...nt(t)});class jt extends st{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map((async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map((e=>new Ue(e.ctx.common.issues)));return Ge(t,{code:Me.invalid_union,unionErrors:r}),He}));{let e;const n=[];for(const s of r){const r={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=n.map((e=>new Ue(e)));return Ge(t,{code:Me.invalid_union,unionErrors:s}),He}}get options(){return this._def.options}}jt.create=(e,t)=>new jt({options:e,typeName:nr.ZodUnion,...nt(t)});const Rt=e=>e instanceof Mt?Rt(e.schema):e instanceof Gt?Rt(e.innerType()):e instanceof Ut?[e.value]:e instanceof Ft?e.options:e instanceof Vt?Object.keys(e.enum):e instanceof Xt?Rt(e._def.innerType):e instanceof _t?[void 0]:e instanceof Et?[null]:null;class Nt extends st{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ze.object)return Ge(t,{code:Me.invalid_type,expected:Ze.object,received:t.parsedType}),He;const r=this.discriminator,n=t.data[r],s=this.optionsMap.get(n);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(Ge(t,{code:Me.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),He)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=Rt(r.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of t){if(n.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);n.set(s,r)}}return new Nt({typeName:nr.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...nt(r)})}}function $t(e,t){const r=De(e),n=De(t);if(e===t)return{valid:!0,data:e};if(r===Ze.object&&n===Ze.object){const r=Ne.objectKeys(t),n=Ne.objectKeys(e).filter((e=>-1!==r.indexOf(e))),s={...e,...t};for(const r of n){const n=$t(e[r],t[r]);if(!n.valid)return{valid:!1};s[r]=n.data}return{valid:!0,data:s}}if(r===Ze.array&&n===Ze.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const s=$t(e[n],t[n]);if(!s.valid)return{valid:!1};r.push(s.data)}return{valid:!0,data:r}}return r===Ze.date&&n===Ze.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class At extends st{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(We(e)||We(n))return He;const s=$t(e.value,n.value);return s.valid?((Je(e)||Je(n))&&t.dirty(),{status:t.value,value:s.data}):(Ge(r,{code:Me.invalid_intersection_types}),He)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}At.create=(e,t,r)=>new At({left:e,right:t,typeName:nr.ZodIntersection,...nt(r)});class Pt extends st{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ze.array)return Ge(r,{code:Me.invalid_type,expected:Ze.array,received:r.parsedType}),He;if(r.data.length<this._def.items.length)return Ge(r,{code:Me.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),He;!this._def.rest&&r.data.length>this._def.items.length&&(Ge(r,{code:Me.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new tt(r,e,r.path,t)):null})).filter((e=>!!e));return r.common.async?Promise.all(n).then((e=>ze.mergeArray(t,e))):ze.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new Pt({...this._def,rest:e})}}Pt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Pt({items:e,typeName:nr.ZodTuple,rest:null,...nt(t)})};class Lt extends st{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ze.object)return Ge(r,{code:Me.invalid_type,expected:Ze.object,received:r.parsedType}),He;const n=[],s=this._def.keyType,i=this._def.valueType;for(const e in r.data)n.push({key:s._parse(new tt(r,e,r.path,e)),value:i._parse(new tt(r,r.data[e],r.path,e))});return r.common.async?ze.mergeObjectAsync(t,n):ze.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new Lt(t instanceof st?{keyType:e,valueType:t,typeName:nr.ZodRecord,...nt(r)}:{keyType:pt.create(),valueType:e,typeName:nr.ZodRecord,...nt(t)})}}class Ct extends st{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ze.map)return Ge(r,{code:Me.invalid_type,expected:Ze.map,received:r.parsedType}),He;const n=this._def.keyType,s=this._def.valueType,i=[...r.data.entries()].map((([e,t],i)=>({key:n._parse(new tt(r,e,r.path,[i,"key"])),value:s._parse(new tt(r,t,r.path,[i,"value"]))})));if(r.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const r of i){const n=await r.key,s=await r.value;if("aborted"===n.status||"aborted"===s.status)return He;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const r of i){const n=r.key,s=r.value;if("aborted"===n.status||"aborted"===s.status)return He;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}}}Ct.create=(e,t,r)=>new Ct({valueType:t,keyType:e,typeName:nr.ZodMap,...nt(r)});class Zt extends st{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ze.set)return Ge(r,{code:Me.invalid_type,expected:Ze.set,received:r.parsedType}),He;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(Ge(r,{code:Me.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(Ge(r,{code:Me.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const s=this._def.valueType;function i(e){const r=new Set;for(const n of e){if("aborted"===n.status)return He;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const a=[...r.data.values()].map(((e,t)=>s._parse(new tt(r,e,r.path,t))));return r.common.async?Promise.all(a).then((e=>i(e))):i(a)}min(e,t){return new Zt({...this._def,minSize:{value:e,message:et.toString(t)}})}max(e,t){return new Zt({...this._def,maxSize:{value:e,message:et.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Zt.create=(e,t)=>new Zt({valueType:e,minSize:null,maxSize:null,typeName:nr.ZodSet,...nt(t)});class Dt extends st{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ze.function)return Ge(t,{code:Me.invalid_type,expected:Ze.function,received:t.parsedType}),He;function r(e,r){return Ke({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ve(),Be].filter((e=>!!e)),issueData:{code:Me.invalid_arguments,argumentsError:r}})}function n(e,r){return Ke({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ve(),Be].filter((e=>!!e)),issueData:{code:Me.invalid_return_type,returnTypeError:r}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof Kt){const e=this;return qe((async function(...t){const a=new Ue([]),o=await e._def.args.parseAsync(t,s).catch((e=>{throw a.addIssue(r(t,e)),a})),u=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(u,s).catch((e=>{throw a.addIssue(n(u,e)),a}))}))}{const e=this;return qe((function(...t){const a=e._def.args.safeParse(t,s);if(!a.success)throw new Ue([r(t,a.error)]);const o=Reflect.apply(i,this,a.data),u=e._def.returns.safeParse(o,s);if(!u.success)throw new Ue([n(o,u.error)]);return u.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Dt({...this._def,args:Pt.create(e).rest(St.create())})}returns(e){return new Dt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Dt({args:e||Pt.create([]).rest(St.create()),returns:t||St.create(),typeName:nr.ZodFunction,...nt(r)})}}class Mt extends st{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Mt.create=(e,t)=>new Mt({getter:e,typeName:nr.ZodLazy,...nt(t)});class Ut extends st{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Ge(t,{received:t.data,code:Me.invalid_literal,expected:this._def.value}),He}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Bt(e,t){return new Ft({values:e,typeName:nr.ZodEnum,...nt(t)})}Ut.create=(e,t)=>new Ut({value:e,typeName:nr.ZodLiteral,...nt(t)});class Ft extends st{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return Ge(t,{expected:Ne.joinValues(r),received:t.parsedType,code:Me.invalid_type}),He}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return Ge(t,{received:t.data,code:Me.invalid_enum_value,options:r}),He}return qe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Ft.create(e)}exclude(e){return Ft.create(this.options.filter((t=>!e.includes(t))))}}Ft.create=Bt;class Vt extends st{_parse(e){const t=Ne.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ze.string&&r.parsedType!==Ze.number){const e=Ne.objectValues(t);return Ge(r,{expected:Ne.joinValues(e),received:r.parsedType,code:Me.invalid_type}),He}if(-1===t.indexOf(e.data)){const e=Ne.objectValues(t);return Ge(r,{received:r.data,code:Me.invalid_enum_value,options:e}),He}return qe(e.data)}get enum(){return this._def.values}}Vt.create=(e,t)=>new Vt({values:e,typeName:nr.ZodNativeEnum,...nt(t)});class Kt extends st{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ze.promise&&!1===t.common.async)return Ge(t,{code:Me.invalid_type,expected:Ze.promise,received:t.parsedType}),He;const r=t.parsedType===Ze.promise?t.data:Promise.resolve(t.data);return qe(r.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Kt.create=(e,t)=>new Kt({type:e,typeName:nr.ZodPromise,...nt(t)});class Gt extends st{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,s={addIssue:e=>{Ge(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===n.type){const e=n.transform(r.data,s);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r}))):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?He:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((r=>"aborted"===r.status?He:("dirty"===r.status&&t.dirty(),e(r.value).then((()=>({status:t.value,value:r.value}))))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ye(e))return e;const i=n.transform(e.value,s);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>Ye(e)?Promise.resolve(n.transform(e.value,s)).then((e=>({status:t.value,value:e}))):e))}Ne.assertNever(n)}}Gt.create=(e,t,r)=>new Gt({schema:e,typeName:nr.ZodEffects,effect:t,...nt(r)}),Gt.createWithPreprocess=(e,t,r)=>new Gt({schema:t,effect:{type:"preprocess",transform:e},typeName:nr.ZodEffects,...nt(r)});class zt extends st{_parse(e){return this._getType(e)===Ze.undefined?qe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}zt.create=(e,t)=>new zt({innerType:e,typeName:nr.ZodOptional,...nt(t)});class Ht extends st{_parse(e){return this._getType(e)===Ze.null?qe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ht.create=(e,t)=>new Ht({innerType:e,typeName:nr.ZodNullable,...nt(t)});class Xt extends st{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===Ze.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Xt.create=(e,t)=>new Xt({innerType:e,typeName:nr.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...nt(t)});class qt extends st{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Qe(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Ue(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new Ue(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}qt.create=(e,t)=>new qt({innerType:e,typeName:nr.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...nt(t)});class Wt extends st{_parse(e){if(this._getType(e)!==Ze.nan){const t=this._getOrReturnCtx(e);return Ge(t,{code:Me.invalid_type,expected:Ze.nan,received:t.parsedType}),He}return{status:"valid",value:e.data}}}Wt.create=e=>new Wt({typeName:nr.ZodNaN,...nt(e)});const Jt=Symbol("zod_brand");class Yt extends st{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Qt extends st{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?He:"dirty"===e.status?(t.dirty(),Xe(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})()}{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?He:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new Qt({in:e,out:t,typeName:nr.ZodPipeline})}}class er extends st{_parse(e){const t=this._def.innerType._parse(e);return Ye(t)&&(t.value=Object.freeze(t.value)),t}}er.create=(e,t)=>new er({innerType:e,typeName:nr.ZodReadonly,...nt(t)});const tr=(e,t={},r)=>e?wt.create().superRefine(((n,s)=>{var i,a;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:r)||void 0===a||a,u="string"==typeof e?{message:e}:e;s.addIssue({code:"custom",...u,fatal:o})}})):wt.create(),rr={object:It.lazycreate};var nr;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(nr||(nr={}));const sr=pt.create,ir=mt.create,ar=Wt.create,or=yt.create,ur=vt.create,cr=gt.create,lr=bt.create,dr=_t.create,hr=Et.create,pr=wt.create,fr=St.create,mr=xt.create,yr=Tt.create,vr=Ot.create,gr=It.create,br=It.strictCreate,_r=jt.create,Er=Nt.create,wr=At.create,Sr=Pt.create,xr=Lt.create,Tr=Ct.create,Or=Zt.create,kr=Dt.create,Ir=Mt.create,jr=Ut.create,Rr=Ft.create,Nr=Vt.create,$r=Kt.create,Ar=Gt.create,Pr=zt.create,Lr=Ht.create,Cr=Gt.createWithPreprocess,Zr=Qt.create,Dr={string:e=>pt.create({...e,coerce:!0}),number:e=>mt.create({...e,coerce:!0}),boolean:e=>vt.create({...e,coerce:!0}),bigint:e=>yt.create({...e,coerce:!0}),date:e=>gt.create({...e,coerce:!0})},Mr=He;var Ur=Object.freeze({__proto__:null,defaultErrorMap:Be,setErrorMap:function(e){Fe=e},getErrorMap:Ve,makeIssue:Ke,EMPTY_PATH:[],addIssueToContext:Ge,ParseStatus:ze,INVALID:He,DIRTY:Xe,OK:qe,isAborted:We,isDirty:Je,isValid:Ye,isAsync:Qe,get util(){return Ne},get objectUtil(){return $e},ZodParsedType:Ze,getParsedType:De,ZodType:st,ZodString:pt,ZodNumber:mt,ZodBigInt:yt,ZodBoolean:vt,ZodDate:gt,ZodSymbol:bt,ZodUndefined:_t,ZodNull:Et,ZodAny:wt,ZodUnknown:St,ZodNever:xt,ZodVoid:Tt,ZodArray:Ot,ZodObject:It,ZodUnion:jt,ZodDiscriminatedUnion:Nt,ZodIntersection:At,ZodTuple:Pt,ZodRecord:Lt,ZodMap:Ct,ZodSet:Zt,ZodFunction:Dt,ZodLazy:Mt,ZodLiteral:Ut,ZodEnum:Ft,ZodNativeEnum:Vt,ZodPromise:Kt,ZodEffects:Gt,ZodTransformer:Gt,ZodOptional:zt,ZodNullable:Ht,ZodDefault:Xt,ZodCatch:qt,ZodNaN:Wt,BRAND:Jt,ZodBranded:Yt,ZodPipeline:Qt,ZodReadonly:er,custom:tr,Schema:st,ZodSchema:st,late:rr,get ZodFirstPartyTypeKind(){return nr},coerce:Dr,any:pr,array:vr,bigint:or,boolean:ur,date:cr,discriminatedUnion:Er,effect:Ar,enum:Rr,function:kr,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>tr((t=>t instanceof e),t),intersection:wr,lazy:Ir,literal:jr,map:Tr,nan:ar,nativeEnum:Nr,never:mr,null:hr,nullable:Lr,number:ir,object:gr,oboolean:()=>ur().optional(),onumber:()=>ir().optional(),optional:Pr,ostring:()=>sr().optional(),pipeline:Zr,preprocess:Cr,promise:$r,record:xr,set:Or,strictObject:br,string:sr,symbol:lr,transformer:Ar,tuple:Sr,undefined:dr,union:_r,unknown:fr,void:yr,NEVER:Mr,ZodIssueCode:Me,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Ue}),Br=["interface","display","layout","module","panel","theme"],Fr=["hook","endpoint"],Vr=["operation"],Kr=Ur.object({app:Ur.string(),api:Ur.string()}),Gr=Ur.object({request:Ur.optional(Ur.object({urls:Ur.array(Ur.string()),methods:Ur.array(Ur.union([Ur.literal("GET"),Ur.literal("POST"),Ur.literal("PATCH"),Ur.literal("PUT"),Ur.literal("DELETE")]))})),log:Ur.optional(Ur.object({})),sleep:Ur.optional(Ur.object({}))}),zr=Ur.optional(Ur.object({enabled:Ur.boolean(),requestedScopes:Gr})),Hr=Ur.union([Ur.object({type:Ur.enum(Fr),name:Ur.string(),source:Ur.string()}),Ur.object({type:Ur.enum(Br),name:Ur.string(),source:Ur.string()}),Ur.object({type:Ur.enum(Vr),name:Ur.string(),source:Kr})]),Xr=Ur.object({host:Ur.string(),hidden:Ur.boolean().optional()}),qr=Ur.object({type:Ur.enum(Br),path:Ur.string(),source:Ur.string()}),Wr=Ur.object({type:Ur.enum(Fr),path:Ur.string(),source:Ur.string(),sandbox:zr}),Jr=Ur.object({type:Ur.enum(Vr),path:Kr,source:Kr,sandbox:zr}),Yr=Ur.object({type:Ur.literal("bundle"),path:Kr,entries:Ur.array(Hr)});Ur.array(Hr);var Qr=Xr.and(Ur.union([qr,Wr,Jr,Yr]));Ur.object({name:Ur.string(),version:Ur.string(),type:Ur.union([Ur.literal("module"),Ur.literal("commonjs")]).optional(),description:Ur.string().optional(),icon:Ur.string().optional(),dependencies:Ur.record(Ur.string()).optional(),devDependencies:Ur.record(Ur.string()).optional(),"directus:extension":Qr});var en={},tn={exports:{}};
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
!function(t,r){var n=e,s=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=n:(i(n,r),r.Buffer=a),a.prototype=Object.create(s.prototype),i(s,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}(tn,tn.exports);var rn=tn.exports,nn=rn.Buffer,sn=t;function an(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=nn.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=nn.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}r.inherits(an,sn),an.prototype.write=function(e){this.buffer=nn.concat([this.buffer,nn.from(e)]),this.emit("data",e)},an.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var on=an,un=e.Buffer,cn=e.SlowBuffer,ln=dn;function dn(e,t){if(!un.isBuffer(e)||!un.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}dn.install=function(){un.prototype.equal=cn.prototype.equal=function(e){return dn(this,e)}};var hn=un.prototype.equal,pn=cn.prototype.equal;function fn(e){return(e/8|0)+(e%8==0?0:1)}dn.restore=function(){un.prototype.equal=hn,cn.prototype.equal=pn};var mn={ES256:fn(256),ES384:fn(384),ES512:fn(521)};var yn=function(e){var t=mn[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')},vn=rn.Buffer,gn=yn,bn=128;function _n(e){if(vn.isBuffer(e))return e;if("string"==typeof e)return vn.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function En(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=bn&&--n,n}var wn={derToJose:function(e,t){e=_n(e);var r=gn(t),n=r+1,s=e.length,i=0;if(48!==e[i++])throw new Error('Could not find expected "seq"');var a=e[i++];if(a===(1|bn)&&(a=e[i++]),s-i<a)throw new Error('"seq" specified length of "'+a+'", only "'+(s-i)+'" remaining');if(2!==e[i++])throw new Error('Could not find expected "int" for "r"');var o=e[i++];if(s-i-2<o)throw new Error('"r" specified length of "'+o+'", only "'+(s-i-2)+'" available');if(n<o)throw new Error('"r" specified length of "'+o+'", max of "'+n+'" is acceptable');var u=i;if(i+=o,2!==e[i++])throw new Error('Could not find expected "int" for "s"');var c=e[i++];if(s-i!==c)throw new Error('"s" specified length of "'+c+'", expected "'+(s-i)+'"');if(n<c)throw new Error('"s" specified length of "'+c+'", max of "'+n+'" is acceptable');var l=i;if((i+=c)!==s)throw new Error('Expected to consume entire buffer, but "'+(s-i)+'" bytes remain');var d=r-o,h=r-c,p=vn.allocUnsafe(d+o+h+c);for(i=0;i<d;++i)p[i]=0;e.copy(p,i,u+Math.max(-d,0),u+o);for(var f=i=r;i<f+h;++i)p[i]=0;return e.copy(p,i,l+Math.max(-h,0),l+c),p=(p=p.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=_n(e);var r=gn(t),n=e.length;if(n!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+n+'"');var s=En(e,0,r),i=En(e,r,e.length),a=r-s,o=r-i,u=2+a+1+1+o,c=u<bn,l=vn.allocUnsafe((c?2:3)+u),d=0;return l[d++]=48,c?l[d++]=u:(l[d++]=1|bn,l[d++]=255&u),l[d++]=2,l[d++]=a,s<0?(l[d++]=0,d+=e.copy(l,d,0,r)):d+=e.copy(l,d,s,r),l[d++]=2,l[d++]=o,i<0?(l[d++]=0,e.copy(l,d,r)):e.copy(l,d,r+i),l}},Sn=ln,xn=rn.Buffer,Tn=n,On=wn,kn=r,In="secret must be a string or buffer",jn="key must be a string or a buffer",Rn="key must be a string, a buffer or an object",Nn="function"==typeof Tn.createPublicKey;function $n(e){if(!xn.isBuffer(e)&&"string"!=typeof e){if(!Nn)throw Cn(jn);if("object"!=typeof e)throw Cn(jn);if("string"!=typeof e.type)throw Cn(jn);if("string"!=typeof e.asymmetricKeyType)throw Cn(jn);if("function"!=typeof e.export)throw Cn(jn)}}function An(e){if(!xn.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw Cn(Rn)}function Pn(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ln(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function Cn(e){var t=[].slice.call(arguments,1),r=kn.format.bind(kn,e).apply(null,t);return new TypeError(r)}function Zn(e){var t;return t=e,xn.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function Dn(e){return function(t,r){!function(e){if(!xn.isBuffer(e)){if("string"==typeof e)return e;if(!Nn)throw Cn(In);if("object"!=typeof e)throw Cn(In);if("secret"!==e.type)throw Cn(In);if("function"!=typeof e.export)throw Cn(In)}}(r),t=Zn(t);var n=Tn.createHmac("sha"+e,r);return Pn((n.update(t),n.digest("base64")))}}function Mn(e){return function(t,r,n){var s=Dn(e)(t,n);return Sn(xn.from(r),xn.from(s))}}function Un(e){return function(t,r){An(r),t=Zn(t);var n=Tn.createSign("RSA-SHA"+e);return Pn((n.update(t),n.sign(r,"base64")))}}function Bn(e){return function(t,r,n){$n(n),t=Zn(t),r=Ln(r);var s=Tn.createVerify("RSA-SHA"+e);return s.update(t),s.verify(n,r,"base64")}}function Fn(e){return function(t,r){An(r),t=Zn(t);var n=Tn.createSign("RSA-SHA"+e);return Pn((n.update(t),n.sign({key:r,padding:Tn.constants.RSA_PKCS1_PSS_PADDING,saltLength:Tn.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function Vn(e){return function(t,r,n){$n(n),t=Zn(t),r=Ln(r);var s=Tn.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:n,padding:Tn.constants.RSA_PKCS1_PSS_PADDING,saltLength:Tn.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function Kn(e){var t=Un(e);return function(){var r=t.apply(null,arguments);return r=On.derToJose(r,"ES"+e)}}function Gn(e){var t=Bn(e);return function(r,n,s){return n=On.joseToDer(n,"ES"+e).toString("base64"),t(r,n,s)}}function zn(){return function(){return""}}function Hn(){return function(e,t){return""===t}}Nn&&(jn+=" or a KeyObject",In+="or a KeyObject");var Xn=function(e){var t={hs:Dn,rs:Un,ps:Fn,es:Kn,none:zn},r={hs:Mn,rs:Bn,ps:Vn,es:Gn,none:Hn},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw Cn('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var s=(n[1]||n[3]).toLowerCase(),i=n[2];return{sign:t[s](i),verify:r[s](i)}},qn=e.Buffer,Wn=function(e){return"string"==typeof e?e:"number"==typeof e||qn.isBuffer(e)?e.toString():JSON.stringify(e)},Jn=rn.Buffer,Yn=on,Qn=Xn,es=t,ts=Wn,rs=r;function ns(e,t){return Jn.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ss(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,s=e.encoding,i=Qn(t.alg),a=function(e,t,r){r=r||"utf8";var n=ns(ts(e),"binary"),s=ns(ts(t),r);return rs.format("%s.%s",n,s)}(t,r,s),o=i.sign(a,n);return rs.format("%s.%s",a,o)}function is(e){var t=e.secret||e.privateKey||e.key,r=new Yn(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new Yn(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}rs.inherits(is,es),is.prototype.sign=function(){try{var e=ss({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},is.sign=ss;var as=is,os=rn.Buffer,us=on,cs=Xn,ls=t,ds=Wn,hs=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function ps(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}function fs(e){var t=e.split(".",1)[0];return ps(os.from(t,"base64").toString("binary"))}function ms(e){return e.split(".")[2]}function ys(e){return hs.test(e)&&!!fs(e)}function vs(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var s=ms(e=ds(e)),i=function(e){return e.split(".",2).join(".")}(e);return cs(t).verify(i,s,r)}function gs(e,t){if(t=t||{},!ys(e=ds(e)))return null;var r=fs(e);if(!r)return null;var n=function(e,t){t=t||"utf8";var r=e.split(".")[1];return os.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(n=JSON.parse(n,t.encoding)),{header:r,payload:n,signature:ms(e)}}function bs(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new us(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new us(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}r.inherits(bs,ls),bs.prototype.verify=function(){try{var e=vs(this.signature.buffer,this.algorithm,this.key.buffer),t=gs(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},bs.decode=gs,bs.isValid=ys,bs.verify=vs;var _s=as,Es=bs;en.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],en.sign=_s.sign,en.verify=Es.verify,en.decode=Es.decode,en.isValid=Es.isValid,en.createSign=function(e){return new _s(e)},en.createVerify=function(e){return new Es(e)};var ws=en,Ss=function(e,t){t=t||{};var r=ws.decode(e,t);if(!r)return null;var n=r.payload;if("string"==typeof n)try{var s=JSON.parse(n);null!==s&&"object"==typeof s&&(n=s)}catch(e){}return!0===t.complete?{header:r.header,payload:n,signature:r.signature}:n},xs=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(xs.prototype=Object.create(Error.prototype)).constructor=xs;var Ts=xs,Os=Ts,ks=function(e,t){Os.call(this,e),this.name="NotBeforeError",this.date=t};(ks.prototype=Object.create(Os.prototype)).constructor=ks;var Is=ks,js=Ts,Rs=function(e,t){js.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(Rs.prototype=Object.create(js.prototype)).constructor=Rs;var Ns=Rs,$s=1e3,As=60*$s,Ps=60*As,Ls=24*Ps,Cs=7*Ls,Zs=365.25*Ls,Ds=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*Zs;case"weeks":case"week":case"w":return r*Cs;case"days":case"day":case"d":return r*Ls;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Ps;case"minutes":case"minute":case"mins":case"min":case"m":return r*As;case"seconds":case"second":case"secs":case"sec":case"s":return r*$s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=Ls)return Ms(e,t,Ls,"day");if(t>=Ps)return Ms(e,t,Ps,"hour");if(t>=As)return Ms(e,t,As,"minute");if(t>=$s)return Ms(e,t,$s,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=Ls)return Math.round(e/Ls)+"d";if(t>=Ps)return Math.round(e/Ps)+"h";if(t>=As)return Math.round(e/As)+"m";if(t>=$s)return Math.round(e/$s)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ms(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}var Us=Ce(Ds),Bs=Ds,Fs=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var n=Bs(e);if(void 0===n)return;return Math.floor(r+n/1e3)}return"number"==typeof e?r+e:void 0},Vs={exports:{}};var Ks={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};var Gs="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=Ks,i=Gs,a=(t=e.exports={}).re=[],o=t.safeRe=[],u=t.src=[],c=t.t={};let l=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",s],[d,n]],p=(e,t,r)=>{const n=(e=>{for(const[t,r]of h)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),s=l++;i(e,s,t),c[e]=s,u[s]=t,a[s]=new RegExp(t,r?"g":void 0),o[s]=new RegExp(n,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),p("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${d}+`),p("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),p("FULL",`^${u[c.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),p("LOOSE",`^${u[c.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),p("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),p("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),p("COERCERTL",u[c.COERCE],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Vs,Vs.exports);var zs=Vs.exports;const Hs=Object.freeze({loose:!0}),Xs=Object.freeze({});var qs=e=>e?"object"!=typeof e?Hs:e:Xs;const Ws=/^[0-9]+$/,Js=(e,t)=>{const r=Ws.test(e),n=Ws.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1};var Ys={compareIdentifiers:Js,rcompareIdentifiers:(e,t)=>Js(t,e)};const Qs=Gs,{MAX_LENGTH:ei,MAX_SAFE_INTEGER:ti}=Ks,{safeRe:ri,t:ni}=zs,si=qs,{compareIdentifiers:ii}=Ys;var ai=class e{constructor(t,r){if(r=si(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>ei)throw new TypeError(`version is longer than ${ei} characters`);Qs("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=t.trim().match(r.loose?ri[ni.LOOSE]:ri[ni.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ti||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ti||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ti||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<ti)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Qs("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),ii(this.major,t.major)||ii(this.minor,t.minor)||ii(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const e=this.prerelease[r],n=t.prerelease[r];if(Qs("prerelease compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return ii(e,n)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{const e=this.build[r],n=t.build[r];if(Qs("prerelease compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return ii(e,n)}while(++r)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===ii(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const oi=ai;var ui=(e,t,r=!1)=>{if(e instanceof oi)return e;try{return new oi(e,t)}catch(e){if(!r)return null;throw e}};const ci=ui;var li=(e,t)=>{const r=ci(e,t);return r?r.version:null};const di=ui;var hi=(e,t)=>{const r=di(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};const pi=ai;var fi=(e,t,r,n,s)=>{"string"==typeof r&&(s=n,n=r,r=void 0);try{return new pi(e instanceof pi?e.version:e,r).inc(t,n,s).version}catch(e){return null}};const mi=ui;var yi=(e,t)=>{const r=mi(e,null,!0),n=mi(t,null,!0),s=r.compare(n);if(0===s)return null;const i=s>0,a=i?r:n,o=i?n:r,u=!!a.prerelease.length;if(!!o.prerelease.length&&!u)return o.patch||o.minor?a.patch?"patch":a.minor?"minor":"major":"major";const c=u?"pre":"";return r.major!==n.major?c+"major":r.minor!==n.minor?c+"minor":r.patch!==n.patch?c+"patch":"prerelease"};const vi=ai;var gi=(e,t)=>new vi(e,t).major;const bi=ai;var _i=(e,t)=>new bi(e,t).minor;const Ei=ai;var wi=(e,t)=>new Ei(e,t).patch;const Si=ui;var xi=(e,t)=>{const r=Si(e,t);return r&&r.prerelease.length?r.prerelease:null};const Ti=ai;var Oi=(e,t,r)=>new Ti(e,r).compare(new Ti(t,r));const ki=Oi;var Ii=(e,t,r)=>ki(t,e,r);const ji=Oi;var Ri=(e,t)=>ji(e,t,!0);const Ni=ai;var $i=(e,t,r)=>{const n=new Ni(e,r),s=new Ni(t,r);return n.compare(s)||n.compareBuild(s)};const Ai=$i;var Pi=(e,t)=>e.sort(((e,r)=>Ai(e,r,t)));const Li=$i;var Ci=(e,t)=>e.sort(((e,r)=>Li(r,e,t)));const Zi=Oi;var Di=(e,t,r)=>Zi(e,t,r)>0;const Mi=Oi;var Ui=(e,t,r)=>Mi(e,t,r)<0;const Bi=Oi;var Fi=(e,t,r)=>0===Bi(e,t,r);const Vi=Oi;var Ki=(e,t,r)=>0!==Vi(e,t,r);const Gi=Oi;var zi=(e,t,r)=>Gi(e,t,r)>=0;const Hi=Oi;var Xi=(e,t,r)=>Hi(e,t,r)<=0;const qi=Fi,Wi=Ki,Ji=Di,Yi=zi,Qi=Ui,ea=Xi;var ta=(e,t,r,n)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return qi(e,r,n);case"!=":return Wi(e,r,n);case">":return Ji(e,r,n);case">=":return Yi(e,r,n);case"<":return Qi(e,r,n);case"<=":return ea(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};const ra=ai,na=ui,{safeRe:sa,t:ia}=zs;var aa,oa,ua,ca,la,da,ha,pa,fa,ma,ya=(e,t)=>{if(e instanceof ra)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=sa[ia.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),sa[ia.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;sa[ia.COERCERTL].lastIndex=-1}else r=e.match(sa[ia.COERCE]);return null===r?null:na(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)};function va(){if(ca)return ua;function e(t){var r=this;if(r instanceof e||(r=new e),r.tail=null,r.head=null,r.length=0,t&&"function"==typeof t.forEach)t.forEach((function(e){r.push(e)}));else if(arguments.length>0)for(var n=0,s=arguments.length;n<s;n++)r.push(arguments[n]);return r}function t(e,t,r){var n=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function r(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function n(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,r,n){if(!(this instanceof s))return new s(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}ca=1,ua=e,e.Node=s,e.create=e,e.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},e.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},e.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},e.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},e.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e]);return this.length},e.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},e.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},e.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},e.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},e.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},e.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},e.prototype.map=function(t,r){r=r||this;for(var n=new e,s=this.head;null!==s;)n.push(t.call(r,s.value,this)),s=s.next;return n},e.prototype.mapReverse=function(t,r){r=r||this;for(var n=new e,s=this.tail;null!==s;)n.push(t.call(r,s.value,this)),s=s.prev;return n},e.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var s=0;null!==n;s++)r=e(r,n.value,s),n=n.next;return r},e.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var s=this.length-1;null!==n;s--)r=e(r,n.value,s),n=n.prev;return r},e.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},e.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},e.prototype.slice=function(t,r){(r=r||this.length)<0&&(r+=this.length),(t=t||0)<0&&(t+=this.length);var n=new e;if(r<t||r<0)return n;t<0&&(t=0),r>this.length&&(r=this.length);for(var s=0,i=this.head;null!==i&&s<t;s++)i=i.next;for(;null!==i&&s<r;s++,i=i.next)n.push(i.value);return n},e.prototype.sliceReverse=function(t,r){(r=r||this.length)<0&&(r+=this.length),(t=t||0)<0&&(t+=this.length);var n=new e;if(r<t||r<0)return n;t<0&&(t=0),r>this.length&&(r=this.length);for(var s=this.length,i=this.tail;null!==i&&s>r;s--)i=i.prev;for(;null!==i&&s>t;s--,i=i.prev)n.push(i.value);return n},e.prototype.splice=function(e,r,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var s=0,i=this.head;null!==i&&s<e;s++)i=i.next;var a=[];for(s=0;i&&s<r;s++)a.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(s=0;s<n.length;s++)i=t(this,i,n[s]);return a},e.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{(oa?aa:(oa=1,aa=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}))(e)}catch(e){}return ua}function ga(){if(pa)return ha;pa=1;class e{constructor(t,r){if(r=n(r),t instanceof e)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new e(t.raw,r);if(t instanceof s)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!f(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&h)|(this.options.loose&&p))+":"+e,n=r.get(t);if(n)return n;const a=this.options.loose,m=a?o[u.HYPHENRANGELOOSE]:o[u.HYPHENRANGE];e=e.replace(m,k(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(o[u.COMPARATORTRIM],c),i("comparator trim",e),e=e.replace(o[u.TILDETRIM],l),i("tilde trim",e),e=e.replace(o[u.CARETTRIM],d),i("caret trim",e);let y=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));a&&(y=y.filter((e=>(i("loose invalid filter",e,this.options),!!e.match(o[u.COMPARATORLOOSE]))))),i("range list",y);const g=new Map,b=y.map((e=>new s(e,this.options)));for(const e of b){if(f(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const _=[...g.values()];return r.set(t,_),_}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>y(e,r)&&t.set.some((t=>y(t,r)&&e.every((e=>t.every((t=>e.intersects(t,r)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new a(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(I(this.set[t],e,this.options))return!0;return!1}}ha=e;const t=function(){if(da)return la;da=1;const e=va(),t=Symbol("max"),r=Symbol("length"),n=Symbol("lengthCalculator"),s=Symbol("allowStale"),i=Symbol("maxAge"),a=Symbol("dispose"),o=Symbol("noDisposeOnSet"),u=Symbol("lruList"),c=Symbol("cache"),l=Symbol("updateAgeOnGet"),d=()=>1,h=(e,t,r)=>{const n=e[c].get(t);if(n){const t=n.value;if(p(e,t)){if(m(e,n),!e[s])return}else r&&(e[l]&&(n.value.now=Date.now()),e[u].unshiftNode(n));return t.value}},p=(e,t)=>{if(!t||!t.maxAge&&!e[i])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[i]&&r>e[i]},f=e=>{if(e[r]>e[t])for(let n=e[u].tail;e[r]>e[t]&&null!==n;){const t=n.prev;m(e,n),n=t}},m=(e,t)=>{if(t){const n=t.value;e[a]&&e[a](n.key,n.value),e[r]-=n.length,e[c].delete(n.key),e[u].removeNode(t)}};class y{constructor(e,t,r,n,s){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=s||0}}const v=(e,t,r,n)=>{let i=r.value;p(e,i)&&(m(e,r),e[s]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};return la=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[t]=e.max||1/0;const r=e.length||d;if(this[n]="function"!=typeof r?d:r,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[i]=e.maxAge||0,this[a]=e.dispose,this[o]=e.noDisposeOnSet||!1,this[l]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[t]=e||1/0,f(this)}get max(){return this[t]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[i]=e,f(this)}get maxAge(){return this[i]}set lengthCalculator(e){"function"!=typeof e&&(e=d),e!==this[n]&&(this[n]=e,this[r]=0,this[u].forEach((e=>{e.length=this[n](e.value,e.key),this[r]+=e.length}))),f(this)}get lengthCalculator(){return this[n]}get length(){return this[r]}get itemCount(){return this[u].length}rforEach(e,t){t=t||this;for(let r=this[u].tail;null!==r;){const n=r.prev;v(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[u].head;null!==r;){const n=r.next;v(this,e,r,t),r=n}}keys(){return this[u].toArray().map((e=>e.key))}values(){return this[u].toArray().map((e=>e.value))}reset(){this[a]&&this[u]&&this[u].length&&this[u].forEach((e=>this[a](e.key,e.value))),this[c]=new Map,this[u]=new e,this[r]=0}dump(){return this[u].map((e=>!p(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[u]}set(e,s,l){if((l=l||this[i])&&"number"!=typeof l)throw new TypeError("maxAge must be a number");const d=l?Date.now():0,h=this[n](s,e);if(this[c].has(e)){if(h>this[t])return m(this,this[c].get(e)),!1;const n=this[c].get(e).value;return this[a]&&(this[o]||this[a](e,n.value)),n.now=d,n.maxAge=l,n.value=s,this[r]+=h-n.length,n.length=h,this.get(e),f(this),!0}const p=new y(e,s,h,d,l);return p.length>this[t]?(this[a]&&this[a](e,s),!1):(this[r]+=p.length,this[u].unshift(p),this[c].set(e,this[u].head),f(this),!0)}has(e){if(!this[c].has(e))return!1;const t=this[c].get(e).value;return!p(this,t)}get(e){return h(this,e,!0)}peek(e){return h(this,e,!1)}pop(){const e=this[u].tail;return e?(m(this,e),e.value):null}del(e){m(this,this[c].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],s=n.e||0;if(0===s)this.set(n.k,n.v);else{const e=s-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[c].forEach(((e,t)=>h(this,t,!1)))}},la}(),r=new t({max:1e3}),n=qs,s=ba(),i=Gs,a=ai,{safeRe:o,t:u,comparatorTrimReplace:c,tildeTrimReplace:l,caretTrimReplace:d}=zs,{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:p}=Ks,f=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,y=(e,t)=>{let r=!0;const n=e.slice();let s=n.pop();for(;r&&n.length;)r=n.every((e=>s.intersects(e,t))),s=n.pop();return r},v=(e,t)=>(i("comp",e,t),e=E(e,t),i("caret",e),e=b(e,t),i("tildes",e),e=S(e,t),i("xrange",e),e=T(e,t),i("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,b=(e,t)=>e.trim().split(/\s+/).map((e=>_(e,t))).join(" "),_=(e,t)=>{const r=t.loose?o[u.TILDELOOSE]:o[u.TILDE];return e.replace(r,((t,r,n,s,a)=>{let o;return i("tilde",e,t,r,n,s,a),g(r)?o="":g(n)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:g(s)?o=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:a?(i("replaceTilde pr",a),o=`>=${r}.${n}.${s}-${a} <${r}.${+n+1}.0-0`):o=`>=${r}.${n}.${s} <${r}.${+n+1}.0-0`,i("tilde return",o),o}))},E=(e,t)=>e.trim().split(/\s+/).map((e=>w(e,t))).join(" "),w=(e,t)=>{i("caret",e,t);const r=t.loose?o[u.CARETLOOSE]:o[u.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,s,a,o)=>{let u;return i("caret",e,t,r,s,a,o),g(r)?u="":g(s)?u=`>=${r}.0.0${n} <${+r+1}.0.0-0`:g(a)?u="0"===r?`>=${r}.${s}.0${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${n} <${+r+1}.0.0-0`:o?(i("replaceCaret pr",o),u="0"===r?"0"===s?`>=${r}.${s}.${a}-${o} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}-${o} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a}-${o} <${+r+1}.0.0-0`):(i("no pr"),u="0"===r?"0"===s?`>=${r}.${s}.${a}${n} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a} <${+r+1}.0.0-0`),i("caret return",u),u}))},S=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map((e=>x(e,t))).join(" ")),x=(e,t)=>{e=e.trim();const r=t.loose?o[u.XRANGELOOSE]:o[u.XRANGE];return e.replace(r,((r,n,s,a,o,u)=>{i("xRange",e,r,n,s,a,o,u);const c=g(s),l=c||g(a),d=l||g(o),h=d;return"="===n&&h&&(n=""),u=t.includePrerelease?"-0":"",c?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(l&&(a=0),o=0,">"===n?(n=">=",l?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):"<="===n&&(n="<",l?s=+s+1:a=+a+1),"<"===n&&(u="-0"),r=`${n+s}.${a}.${o}${u}`):l?r=`>=${s}.0.0${u} <${+s+1}.0.0-0`:d&&(r=`>=${s}.${a}.0${u} <${s}.${+a+1}.0-0`),i("xRange return",r),r}))},T=(e,t)=>(i("replaceStars",e,t),e.trim().replace(o[u.STAR],"")),O=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(o[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),k=e=>(t,r,n,s,i,a,o,u,c,l,d,h,p)=>`${r=g(n)?"":g(s)?`>=${n}.0.0${e?"-0":""}`:g(i)?`>=${n}.${s}.0${e?"-0":""}`:a?`>=${r}`:`>=${r}${e?"-0":""}`} ${u=g(c)?"":g(l)?`<${+c+1}.0.0-0`:g(d)?`<${c}.${+l+1}.0-0`:h?`<=${c}.${l}.${d}-${h}`:e?`<${c}.${l}.${+d+1}-0`:`<=${u}`}`.trim(),I=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(i(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0};return ha}function ba(){if(ma)return fa;ma=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(n,s){if(s=r(s),n instanceof t){if(n.loose===!!s.loose)return n;n=n.value}n=n.trim().split(/\s+/).join(" "),a("comparator",n,s),this.options=s,this.loose=!!s.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const r=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],i=t.match(r);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new o(i[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new o(t,this.options)}catch(e){return!1}return i(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(e.value,n).test(this.value):""===e.operator?""===e.value||new u(this.value,n).test(e.semver):(!(n=r(n)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(i(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(i(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}fa=t;const r=qs,{safeRe:n,t:s}=zs,i=ta,a=Gs,o=ai,u=ga();return fa}const _a=ga();var Ea=(e,t,r)=>{try{t=new _a(t,r)}catch(e){return!1}return t.test(e)};const wa=ga();var Sa=(e,t)=>new wa(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")));const xa=ai,Ta=ga();var Oa=(e,t,r)=>{let n=null,s=null,i=null;try{i=new Ta(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(n&&-1!==s.compare(e)||(n=e,s=new xa(n,r)))})),n};const ka=ai,Ia=ga();var ja=(e,t,r)=>{let n=null,s=null,i=null;try{i=new Ia(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(n&&1!==s.compare(e)||(n=e,s=new ka(n,r)))})),n};const Ra=ai,Na=ga(),$a=Di;var Aa=(e,t)=>{e=new Na(e,t);let r=new Ra("0.0.0");if(e.test(r))return r;if(r=new Ra("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const n=e.set[t];let s=null;n.forEach((e=>{const t=new Ra(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!$a(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||r&&!$a(r,s)||(r=s)}return r&&e.test(r)?r:null};const Pa=ga();var La=(e,t)=>{try{return new Pa(e,t).range||"*"}catch(e){return null}};const Ca=ai,Za=ba(),{ANY:Da}=Za,Ma=ga(),Ua=Ea,Ba=Di,Fa=Ui,Va=Xi,Ka=zi;var Ga=(e,t,r,n)=>{let s,i,a,o,u;switch(e=new Ca(e,n),t=new Ma(t,n),r){case">":s=Ba,i=Va,a=Fa,o=">",u=">=";break;case"<":s=Fa,i=Ka,a=Ba,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ua(e,t,n))return!1;for(let r=0;r<t.set.length;++r){const c=t.set[r];let l=null,d=null;if(c.forEach((e=>{e.semver===Da&&(e=new Za(">=0.0.0")),l=l||e,d=d||e,s(e.semver,l.semver,n)?l=e:a(e.semver,d.semver,n)&&(d=e)})),l.operator===o||l.operator===u)return!1;if((!d.operator||d.operator===o)&&i(e,d.semver))return!1;if(d.operator===u&&a(e,d.semver))return!1}return!0};const za=Ga;var Ha=(e,t,r)=>za(e,t,">",r);const Xa=Ga;var qa=(e,t,r)=>Xa(e,t,"<",r);const Wa=ga();var Ja=(e,t,r)=>(e=new Wa(e,r),t=new Wa(t,r),e.intersects(t,r));const Ya=Ea,Qa=Oi;const eo=ga(),to=ba(),{ANY:ro}=to,no=Ea,so=Oi,io=[new to(">=0.0.0-0")],ao=[new to(">=0.0.0")],oo=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===ro){if(1===t.length&&t[0].semver===ro)return!0;e=r.includePrerelease?io:ao}if(1===t.length&&t[0].semver===ro){if(r.includePrerelease)return!0;t=ao}const n=new Set;let s,i,a,o,u,c,l;for(const t of e)">"===t.operator||">="===t.operator?s=uo(s,t,r):"<"===t.operator||"<="===t.operator?i=co(i,t,r):n.add(t.semver);if(n.size>1)return null;if(s&&i){if(a=so(s.semver,i.semver,r),a>0)return null;if(0===a&&(">="!==s.operator||"<="!==i.operator))return null}for(const e of n){if(s&&!no(e,String(s),r))return null;if(i&&!no(e,String(i),r))return null;for(const n of t)if(!no(e,String(n),r))return!1;return!0}let d=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver,h=!(!s||r.includePrerelease||!s.semver.prerelease.length)&&s.semver;d&&1===d.prerelease.length&&"<"===i.operator&&0===d.prerelease[0]&&(d=!1);for(const e of t){if(l=l||">"===e.operator||">="===e.operator,c=c||"<"===e.operator||"<="===e.operator,s)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),">"===e.operator||">="===e.operator){if(o=uo(s,e,r),o===e&&o!==s)return!1}else if(">="===s.operator&&!no(s.semver,String(e),r))return!1;if(i)if(d&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===d.major&&e.semver.minor===d.minor&&e.semver.patch===d.patch&&(d=!1),"<"===e.operator||"<="===e.operator){if(u=co(i,e,r),u===e&&u!==i)return!1}else if("<="===i.operator&&!no(i.semver,String(e),r))return!1;if(!e.operator&&(i||s)&&0!==a)return!1}return!(s&&c&&!i&&0!==a)&&(!(i&&l&&!s&&0!==a)&&(!h&&!d))},uo=(e,t,r)=>{if(!e)return t;const n=so(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},co=(e,t,r)=>{if(!e)return t;const n=so(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};var lo=(e,t,r={})=>{if(e===t)return!0;e=new eo(e,r),t=new eo(t,r);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=oo(s,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0};const ho=zs,po=Ks,fo=ai,mo=Ys,yo=(e,t,r)=>{const n=[];let s=null,i=null;const a=e.sort(((e,t)=>Qa(e,t,r)));for(const e of a){Ya(e,t,r)?(i=e,s||(s=e)):(i&&n.push([s,i]),i=null,s=null)}s&&n.push([s,null]);const o=[];for(const[e,t]of n)e===t?o.push(e):t||e!==a[0]?t?e===a[0]?o.push(`<=${t}`):o.push(`${e} - ${t}`):o.push(`>=${e}`):o.push("*");const u=o.join(" || "),c="string"==typeof t.raw?t.raw:String(t);return u.length<c.length?u:t};var vo={parse:ui,valid:li,clean:hi,inc:fi,diff:yi,major:gi,minor:_i,patch:wi,prerelease:xi,compare:Oi,rcompare:Ii,compareLoose:Ri,compareBuild:$i,sort:Pi,rsort:Ci,gt:Di,lt:Ui,eq:Fi,neq:Ki,gte:zi,lte:Xi,cmp:ta,coerce:ya,Comparator:ba(),Range:ga(),satisfies:Ea,toComparators:Sa,maxSatisfying:Oa,minSatisfying:ja,minVersion:Aa,validRange:La,outside:Ga,gtr:Ha,ltr:qa,intersects:Ja,simplifyRange:yo,subset:lo,SemVer:fo,re:ho.re,src:ho.src,tokens:ho.t,SEMVER_SPEC_VERSION:po.SEMVER_SPEC_VERSION,RELEASE_TYPES:po.RELEASE_TYPES,compareIdentifiers:mo.compareIdentifiers,rcompareIdentifiers:mo.rcompareIdentifiers};var go=vo.satisfies(process.version,">=15.7.0");var bo=vo.satisfies(process.version,">=16.9.0");const _o=go,Eo=bo,wo={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},So={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};var xo=function(e,t){if(!e||!t)return;const r=t.asymmetricKeyType;if(!r)return;const n=wo[r];if(!n)throw new Error(`Unknown key type "${r}".`);if(!n.includes(e))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${n.join(", ")}.`);if(_o)switch(r){case"ec":const r=t.asymmetricKeyDetails.namedCurve,n=So[e];if(r!==n)throw new Error(`"alg" parameter "${e}" requires curve "${n}".`);break;case"rsa-pss":if(Eo){const r=parseInt(e.slice(-3),10),{hashAlgorithm:n,mgf1HashAlgorithm:s,saltLength:i}=t.asymmetricKeyDetails;if(n!==`sha${r}`||s!==n)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(void 0!==i&&i>r>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}}},To=vo.satisfies(process.version,"^6.12.0 || >=8.0.0");const Oo=Ts,ko=Is,Io=Ns,jo=Ss,Ro=Fs,No=xo,$o=To,Ao=en,{KeyObject:Po,createSecretKey:Lo,createPublicKey:Co}=n,Zo=["RS256","RS384","RS512"],Do=["ES256","ES384","ES512"],Mo=["RS256","RS384","RS512"],Uo=["HS256","HS384","HS512"];$o&&(Zo.splice(Zo.length,0,"PS256","PS384","PS512"),Mo.splice(Mo.length,0,"PS256","PS384","PS512"));var Bo=1/0,Fo=9007199254740991,Vo=17976931348623157e292,Ko=NaN,Go="[object Arguments]",zo="[object Function]",Ho="[object GeneratorFunction]",Xo="[object String]",qo="[object Symbol]",Wo=/^\s+|\s+$/g,Jo=/^[-+]0x[0-9a-f]+$/i,Yo=/^0b[01]+$/i,Qo=/^0o[0-7]+$/i,eu=/^(?:0|[1-9]\d*)$/,tu=parseInt;function ru(e){return e!=e}function nu(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}(t,(function(t){return e[t]}))}var su=Object.prototype,iu=su.hasOwnProperty,au=su.toString,ou=su.propertyIsEnumerable,uu=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),cu=Math.max;function lu(e,t){var r=pu(e)||function(e){return function(e){return yu(e)&&fu(e)}(e)&&iu.call(e,"callee")&&(!ou.call(e,"callee")||au.call(e)==Go)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,s=!!n;for(var i in e)!t&&!iu.call(e,i)||s&&("length"==i||hu(i,n))||r.push(i);return r}function du(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||su,t!==n)return uu(e);var t,r,n,s=[];for(var i in Object(e))iu.call(e,i)&&"constructor"!=i&&s.push(i);return s}function hu(e,t){return!!(t=null==t?Fo:t)&&("number"==typeof e||eu.test(e))&&e>-1&&e%1==0&&e<t}var pu=Array.isArray;function fu(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Fo}(e.length)&&!function(e){var t=mu(e)?au.call(e):"";return t==zo||t==Ho}(e)}function mu(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function yu(e){return!!e&&"object"==typeof e}var vu=function(e,t,r,n){var s;e=fu(e)?e:(s=e)?nu(s,function(e){return fu(e)?lu(e):du(e)}(s)):[],r=r&&!n?function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||yu(e)&&au.call(e)==qo}(e))return Ko;if(mu(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=mu(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Wo,"");var r=Yo.test(e);return r||Qo.test(e)?tu(e.slice(2),r?2:8):Jo.test(e)?Ko:+e}(e),e===Bo||e===-Bo){return(e<0?-1:1)*Vo}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(r):0;var i=e.length;return r<0&&(r=cu(i+r,0)),function(e){return"string"==typeof e||!pu(e)&&yu(e)&&au.call(e)==Xo}(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var s=e.length,i=r+(n?1:-1);n?i--:++i<s;)if(t(e[i],i,e))return i;return-1}(e,ru,r);for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}(e,t,r)>-1},gu=Object.prototype.toString;var bu=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==gu.call(e)},_u=1/0,Eu=17976931348623157e292,wu=NaN,Su="[object Symbol]",xu=/^\s+|\s+$/g,Tu=/^[-+]0x[0-9a-f]+$/i,Ou=/^0b[01]+$/i,ku=/^0o[0-7]+$/i,Iu=parseInt,ju=Object.prototype.toString;function Ru(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var Nu=function(e){return"number"==typeof e&&e==function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&ju.call(e)==Su}(e))return wu;if(Ru(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ru(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(xu,"");var r=Ou.test(e);return r||ku.test(e)?Iu(e.slice(2),r?2:8):Tu.test(e)?wu:+e}(e),e===_u||e===-_u){return(e<0?-1:1)*Eu}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e)},$u=Object.prototype.toString;var Au=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==$u.call(e)};var Pu=Function.prototype,Lu=Object.prototype,Cu=Pu.toString,Zu=Lu.hasOwnProperty,Du=Cu.call(Object),Mu=Lu.toString,Uu=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object);var Bu=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=Mu.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=Uu(e);if(null===t)return!0;var r=Zu.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Cu.call(r)==Du},Fu=Object.prototype.toString,Vu=Array.isArray;var Ku=function(e){return"string"==typeof e||!Vu(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==Fu.call(e)},Gu="Expected a function",zu=1/0,Hu=17976931348623157e292,Xu=NaN,qu="[object Symbol]",Wu=/^\s+|\s+$/g,Ju=/^[-+]0x[0-9a-f]+$/i,Yu=/^0b[01]+$/i,Qu=/^0o[0-7]+$/i,ec=parseInt,tc=Object.prototype.toString;function rc(e,t){var r;if("function"!=typeof t)throw new TypeError(Gu);return e=function(e){var t=function(e){if(!e)return 0===e?e:0;if(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&tc.call(e)==qu}(e))return Xu;if(nc(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=nc(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Wu,"");var r=Yu.test(e);return r||Qu.test(e)?ec(e.slice(2),r?2:8):Ju.test(e)?Xu:+e}(e),e===zu||e===-zu){return(e<0?-1:1)*Hu}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}function nc(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var sc=function(e){return rc(2,e)};const ic=Fs,ac=To,oc=xo,uc=en,cc=vu,lc=bu,dc=Nu,hc=Au,pc=Bu,fc=Ku,mc=sc,{KeyObject:yc,createSecretKey:vc,createPrivateKey:gc}=n,bc=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];ac&&bc.splice(3,0,"PS256","PS384","PS512");const _c={expiresIn:{isValid:function(e){return dc(e)||fc(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return dc(e)||fc(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return fc(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:cc.bind(null,bc),message:'"algorithm" must be a valid string enum value'},header:{isValid:pc,message:'"header" must be an object'},encoding:{isValid:fc,message:'"encoding" must be a string'},issuer:{isValid:fc,message:'"issuer" must be a string'},subject:{isValid:fc,message:'"subject" must be a string'},jwtid:{isValid:fc,message:'"jwtid" must be a string'},noTimestamp:{isValid:lc,message:'"noTimestamp" must be a boolean'},keyid:{isValid:fc,message:'"keyid" must be a string'},mutatePayload:{isValid:lc,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:lc,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:lc,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},Ec={iat:{isValid:hc,message:'"iat" should be a number of seconds'},exp:{isValid:hc,message:'"exp" should be a number of seconds'},nbf:{isValid:hc,message:'"nbf" should be a number of seconds'}};function wc(e,t,r,n){if(!pc(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(s){const i=e[s];if(i){if(!i.isValid(r[s]))throw new Error(i.message)}else if(!t)throw new Error('"'+s+'" is not allowed in "'+n+'"')}))}const Sc={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},xc=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];var Tc={decode:Ss,verify:function(e,t,r,n){let s;if("function"!=typeof r||n||(n=r,r={}),r||(r={}),r=Object.assign({},r),s=n||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return s(new Oo("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return s(new Oo("nonce must be a non-empty string"));if(void 0!==r.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof r.allowInvalidAsymmetricKeyTypes)return s(new Oo("allowInvalidAsymmetricKeyTypes must be a boolean"));const i=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return s(new Oo("jwt must be provided"));if("string"!=typeof e)return s(new Oo("jwt must be a string"));const a=e.split(".");if(3!==a.length)return s(new Oo("jwt malformed"));let o;try{o=jo(e,{complete:!0})}catch(e){return s(e)}if(!o)return s(new Oo("invalid token"));const u=o.header;let c;if("function"==typeof t){if(!n)return s(new Oo("verify must be called asynchronous if secret or public key is provided as a callback"));c=t}else c=function(e,r){return r(null,t)};return c(u,(function(t,n){if(t)return s(new Oo("error in secret or public key callback: "+t.message));const c=""!==a[2].trim();if(!c&&n)return s(new Oo("jwt signature is required"));if(c&&!n)return s(new Oo("secret or public key must be provided"));if(!c&&!r.algorithms)return s(new Oo('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=n&&!(n instanceof Po))try{n=Co(n)}catch(e){try{n=Lo("string"==typeof n?Buffer.from(n):n)}catch(e){return s(new Oo("secretOrPublicKey is not valid key material"))}}if(r.algorithms||("secret"===n.type?r.algorithms=Uo:["rsa","rsa-pss"].includes(n.asymmetricKeyType)?r.algorithms=Mo:"ec"===n.asymmetricKeyType?r.algorithms=Do:r.algorithms=Zo),-1===r.algorithms.indexOf(o.header.alg))return s(new Oo("invalid algorithm"));if(u.alg.startsWith("HS")&&"secret"!==n.type)return s(new Oo(`secretOrPublicKey must be a symmetric key when using ${u.alg}`));if(/^(?:RS|PS|ES)/.test(u.alg)&&"public"!==n.type)return s(new Oo(`secretOrPublicKey must be an asymmetric key when using ${u.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{No(u.alg,n)}catch(e){return s(e)}let l;try{l=Ao.verify(e,o.header.alg,n)}catch(e){return s(e)}if(!l)return s(new Oo("invalid signature"));const d=o.payload;if(void 0!==d.nbf&&!r.ignoreNotBefore){if("number"!=typeof d.nbf)return s(new Oo("invalid nbf value"));if(d.nbf>i+(r.clockTolerance||0))return s(new ko("jwt not active",new Date(1e3*d.nbf)))}if(void 0!==d.exp&&!r.ignoreExpiration){if("number"!=typeof d.exp)return s(new Oo("invalid exp value"));if(i>=d.exp+(r.clockTolerance||0))return s(new Io("jwt expired",new Date(1e3*d.exp)))}if(r.audience){const e=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(d.aud)?d.aud:[d.aud]).some((function(t){return e.some((function(e){return e instanceof RegExp?e.test(t):e===t}))})))return s(new Oo("jwt audience invalid. expected: "+e.join(" or ")))}if(r.issuer){if("string"==typeof r.issuer&&d.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(d.iss))return s(new Oo("jwt issuer invalid. expected: "+r.issuer))}if(r.subject&&d.sub!==r.subject)return s(new Oo("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&d.jti!==r.jwtid)return s(new Oo("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&d.nonce!==r.nonce)return s(new Oo("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof d.iat)return s(new Oo("iat required when maxAge is specified"));const e=Ro(r.maxAge,d.iat);if(void 0===e)return s(new Oo('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=e+(r.clockTolerance||0))return s(new Io("maxAge exceeded",new Date(1e3*e)))}if(!0===r.complete){const e=o.signature;return s(null,{header:u,payload:d,signature:e})}return s(null,d)}))},sign:function(e,t,r,n){"function"==typeof r?(n=r,r={}):r=r||{};const s="object"==typeof e&&!Buffer.isBuffer(e),i=Object.assign({alg:r.algorithm||"HS256",typ:s?"JWT":void 0,kid:r.keyid},r.header);function a(e){if(n)return n(e);throw e}if(!t&&"none"!==r.algorithm)return a(new Error("secretOrPrivateKey must have a value"));if(null!=t&&!(t instanceof yc))try{t=gc(t)}catch(e){try{t=vc("string"==typeof t?Buffer.from(t):t)}catch(e){return a(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&"secret"!==t.type)return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if("private"!==t.type)return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!r.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&void 0!==t.asymmetricKeyDetails&&t.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(void 0===e)return a(new Error("payload is required"));if(s){try{!function(e){wc(Ec,!0,e,"payload")}(e)}catch(e){return a(e)}r.mutatePayload||(e=Object.assign({},e))}else{const t=xc.filter((function(e){return void 0!==r[e]}));if(t.length>0)return a(new Error("invalid "+t.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){wc(_c,!1,e,"options")}(r)}catch(e){return a(e)}if(!r.allowInvalidAsymmetricKeyTypes)try{oc(i.alg,t)}catch(e){return a(e)}const o=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:s&&(e.iat=o),void 0!==r.notBefore){try{e.nbf=ic(r.notBefore,o)}catch(e){return a(e)}if(void 0===e.nbf)return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==r.expiresIn&&"object"==typeof e){try{e.exp=ic(r.expiresIn,o)}catch(e){return a(e)}if(void 0===e.exp)return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(Sc).forEach((function(t){const n=Sc[t];if(void 0!==r[t]){if(void 0!==e[n])return a(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}}));const u=r.encoding||"utf8";if("function"!=typeof n){let n=uc.sign({header:i,payload:e,secret:t,encoding:u});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&n.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return n}n=n&&mc(n),uc.createSign({header:i,privateKey:t,payload:e,encoding:u}).once("error",n).once("done",(function(e){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&e.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,e)}))},JsonWebTokenError:Ts,NotBeforeError:Is,TokenExpiredError:Ns},Oc=Ce(Tc),kc={};const Ic=(e,t)=>new Promise(((r,n)=>{(function(e){var t=a.parse(e);if("https:"!==t.protocol)return!1;var r=t.hostname.split("."),n=r.length;return"apple.com"===r.slice(n-2,n).join(".")})(e)||n(new Error("Invalid publicKeyUrl")),kc[e]&&(t.info(`Cache HIT: ${e}`),r(kc[e])),o.get(e,(function(t){var n="";t.on("data",(function(e){n+=e.toString("base64")})),t.on("end",(function(){var s="-----BEGIN CERTIFICATE-----\n"+n.match(new RegExp(".{0,64}","g")).join("\n")+"-----END CERTIFICATE-----";if(t.headers["cache-control"]){var i=t.headers["cache-control"].match(/max-age=([0-9]+)/);i&&(kc[e]=s,setTimeout((function(){delete kc[e]}),1e3*parseInt(i[1],10)))}r(s)}))})).on("error",(function(e){n(e)}))}));function jc(e,t,r,n,s,a){var o=i("sha256");if(o.update(t,"utf8"),o.update(r,"utf8"),o.update(function(e){var t=new Buffer.alloc(8);t.fill(0);var r=~~(e/4294967295),n=e%4294967296;return t.writeUInt32BE(parseInt(r,10),0),t.writeUInt32BE(parseInt(n,10),4),t}(n)),o.update(s,"base64"),!o.verify(e,a,"base64"))throw new Error("Invalid Signature")}var Rc={id:"gamecenter",handler:(e,t)=>{const{services:r,getSchema:n,env:s,logger:i}=t,{UsersService:a,ItemsService:o}=r;e.post("/callback",(async(e,t)=>{const r=await n(),u=new a({schema:r}),c=new o("directus_sessions",{schema:r});if(!e.body.publicKeyURL||Le(e.body.publicKeyURL))return t.status(422).json({error:"Need publickKeyURL"});if(!e.body.teamPlayerId||Le(e.body.teamPlayerId))return t.status(422).json({error:"Need teamPlayerId"});if(!e.body.signature||Le(e.body.signature))return t.status(422).json({error:"Need signature"});if(!e.body.salt||Le(e.body.salt))return t.status(422).json({error:"Need salt"});if(!e.body.timestamp||Le(e.body.timestamp))return t.status(422).json({error:"Need timestamp"});const l=await Ic(e.body.publicKeyURL,i);try{jc(l,e.body.teamPlayerId,s.IOS_BUNDLE_ID,e.body.timestamp,e.body.salt,e.body.signature)}catch(e){return i.error(`Error verifying signature: ${e}`),t.status(444).json({error:"Could not verify signature, unknown error"}).end()}const h=`${btoa(e.body.teamPlayerId)}@gknoemail.com`;let p=await u.getUserByEmail(h);try{Le(p)?p=await u.createOne({provider:"apple",first_name:e.body.alias,last_name:e.body.displayName,email:h,external_identifier:e.body.teamPlayerId,role:s.AUTH_GOOGLE_DEFAULT_ROLE_ID}):await u.updateOne(p.id,{first_name:e.body.alias,last_name:e.body.displayName})}catch(e){return t.status(500).json({error:"Exception:Could not access / create user for this AuthCode"}).end()}try{const e=Oc.sign({id:p.id,role:s.AUTH_GOOGLE_DEFAULT_ROLE_ID,app_access:!1,admin_access:!1},s.SECRET,{expiresIn:s.ACCESS_TOKEN_TTL,issuer:"directus"}),r=d(64),n=new Date(Date.now()+Us(s.REFRESH_TOKEN_TTL));return await c.createOne({token:r,user:p.id,expires:n}),t.json({access_token:e,refresh_token:r,expires:Us(s.ACCESS_TOKEN_TTL)})}catch(e){return t.status(500).json({error:"Exception:Could not create / sign access tokens for this Auth Code"}).end()}}))}};export{Rc as default};
